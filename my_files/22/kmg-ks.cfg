#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T

#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone Europe/Zurich
#Root password
rootpw --disabled
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel 
#System authorization infomation
auth  --useshadow  --enablemd5 
#Firewall configuration
firewall --disabled 
#Do not configure the X Window System
skipx
%packages
#@ ubuntu-server
openssh-server
python-apt
python
bind9-host
dnsutils
man
whois
wget
#debconf-utils
%post
cp /etc/rc.local /etc/rc.local.org
sed -i '/%sudo/ s/ALL$/NOPASSWD: ALL/' /etc/sudoers
update-alternatives --set editor /usr/bin/vim.tiny
cat<<EOT > /etc/network/if-up.d/show-ip-address
#!/bin/sh
if [ "\$METHOD" = loopback ]; then
    exit 0
fi

# Only run from ifup.
if [ "\$MODE" != start ]; then
    exit 0
fi

IP=\$(/sbin/ifconfig | /bin/grep "inet addr" | /bin/grep -v "127.0.0.1" | /usr/bin/awk '{ print \$2 }' | /usr/bin/awk -F: '{ print \$2 }')
VERSION=\$(/bin/cat /etc/lsb-release | /bin/grep "^DISTRIB_DESCRIPTION" | /usr/bin/cut -d"=" -f2 | /bin/sed -e 's/"//g')
echo "IP: \$IP" > /etc/issue
echo "\$VERSION \\l" >> /etc/issue
EOT
chmod 755 /etc/network/if-up.d/show-ip-address
